<% include partials/cabecalho %>

<h1 align="center">{{ titulo }}</h1>
<div class="container table-responsive-md ">
    <table border="1" class=" table-fixed table text-center  table-dark table-striped table-bordered table-hover">
    <thead class="thead-dark">
        <tr>
            <th scope="col">Nome</th>
            <th scope="col">Descrição</th>
            <th scope="col">Preço</th>
            <th scope="col" v-if="usuario == 'admin'">Ações</th>           
        </tr>
    </thead>
    <tbody >
        <tr v-for="pizza in pizzas">
            <td width="20%">{{ pizza.nome }}</td>
            <td width="40%">{{ pizza.descricao }}</td>
            <td width="20%">R$ {{ pizza.preco.$numberDecimal }}</td> 
                               
            <td width="20%" v-if="usuario == 'admin'">
                <div class="row" ALIGN="center"> 
                    <div class="col">
                        <!-- a style="width: 100%;" class="btn btn-xs btn-primary mesmo-tamanho" href="#/" v-on:click="altera_process(contato._id)">Atualizar</a-->                                       
                            <!-- Button trigger modal -->
                        <button type="button" class="btn btn-primary mesmo-tamanh" data-toggle="modal" v-bind:data-target="`#exampleModal` + pizza._id">
                        Atualizar
                        </button>
                    </div>           
                    <div class="col" style="float: left;">             
                        <a style="width: 100%;" class="btn btn-xs btn-danger mesmo-tamanho" href="#/" v-on:click="deleta(contato._id)">Deletar</a>
                    </div>                    
                </div>

                <!-- Modal -->
                <div style="color: black;" class="modal fade" v-bind:id="`exampleModal` + pizza._id" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                    <div class="modal-header">
                        <h5 style="color: black;" class="modal-title" id="exampleModalLabel">Deseja realmente atualizar esta pizza?</h5>                        
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div style="color: black;" class="modal-body">
                        <form class="">
                            <div class="form-group">
                                <label for="nome" class="control-label">Nome:</label>
                                <input name="nome" type="text" class="form-control" id="nome" v-bind:placeholder="pizza.nome">
                            </div>

                            <div class="form-group">
                                <label for="descricao" class="control-label">Descrição:</label>
                                <input name="descricao" type="text" class="form-control" id="nome" v-bind:placeholder="pizza.descricao">
                            </div>

                            <div class="form-group">
                                <label for="preco" class="control-label">Preço:</label>
                                <input name="preco" type="text" class="form-control" id="nome" v-bind:placeholder="pizza.preco.$numberDecimal">
                            </div>

                            <div class="form-group">
                                <label for="identificador" class="control-label">Identificador:</label>
                                <input name="identificador" type="text" class="form-control" id="nome" v-bind:placeholder="pizza._id ">
                            </div>                          
                        </form>                                              

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
                        <button type="button" class="btn btn-primary">Salvar Mudanças</button>
                    </div>
                    </div>
                </div>
                </div>
            </td>                        
        </tr>
    </tbody>
</table>
</div>

<script>
    // Criar metodo para atualizar os dados modificados
	var app = new Vue({
	  el: '#pizzaria',
	  data: {
          pizzas: [],
		  titulo: 'Cardápio de Pizzas',
          usuario: '',
          random: Math.floor(Math.random() * 10)
	  },
	  methods:{
	  },
	  mounted:() => {
	  	axios.get('/usuario')
	    .then((response) => app.usuario = response.data)
        .catch((error) => console.log(error));

        axios.get('/pizzas')       
		.then((response) => app.pizzas = response.data)
		.catch((error) => console.log(error));
	 }
  })

 </script>

<% include partials/rodape %>
